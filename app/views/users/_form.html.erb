<%= form_with model: user, local: true do |form| %>
  <% if user.errors.any? %>
    <div class="alert alert-danger">
      <h6>Please fix the following errors:</h6>
      <ul class="mb-0">
        <% user.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="row mb-3">
    <div class="col-md-6">
      <%= form.label :first_name, class: "form-label" %>
      <%= form.text_field :first_name, class: "form-control", placeholder: "First name", required: true %>
    </div>
    <div class="col-md-6">
      <%= form.label :last_name, class: "form-label" %>
      <%= form.text_field :last_name, class: "form-control", placeholder: "Last name", required: true %>
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-md-6">
      <%= form.label :email, class: "form-label" %>
      <%= form.email_field :email, class: "form-control", placeholder: "user@example.com", required: true %>
    </div>
    <div class="col-md-6">
      <%= form.label :phone, class: "form-label" %>
      <%= form.telephone_field :phone, class: "form-control", placeholder: "+254 700 000 000" %>
    </div>
  </div>

  <% password_required = user.new_record? %>
  <div class="row mb-3">
    <div class="col-md-6">
      <%= form.label :password, class: "form-label" %>
      <%= form.password_field :password, class: "form-control", placeholder: "Minimum 6 characters", required: password_required %>
    </div>
    <div class="col-md-6">
      <%= form.label :password_confirmation, class: "form-label" %>
      <%= form.password_field :password_confirmation, class: "form-control", placeholder: "Confirm password", required: password_required %>
    </div>
  </div>
  <% unless password_required %>
    <div class="form-text mb-3">Leave password fields blank to keep the current password.</div>
  <% end %>

  <div class="mb-4">
    <%= form.label :role, class: "form-label" %>
    <%= form.select :role,
        options_for_select([
          ['Farm Worker', 'farm_worker'],
          ['Farm Manager', 'farm_manager'],
          ['Veterinarian', 'veterinarian'],
          ['Farm Owner', 'farm_owner']
        ], user.role),
        { prompt: 'Select a role' },
        { class: "form-select", required: true } %>
    <div class="form-text">
      <strong>Roles Explained:</strong><br>
      <strong>Farm Worker:</strong> Can add production records and view basic data<br>
      <strong>Farm Manager:</strong> Full access including reports and user management<br>
      <strong>Veterinarian:</strong> Can view reports and cow health data<br>
      <strong>Farm Owner:</strong> Full system access and control
    </div>
  </div>

  <div class="d-flex justify-content-end">
    <%= link_to "Cancel", users_path, class: "btn btn-secondary me-2" %>
    <%= form.submit submit_label, class: "btn btn-primary" %>
  </div>
<% end %>
